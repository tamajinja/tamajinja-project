# rules_非表示テキスト優先誤動作対策_20250612.md

## 概要
ChatGPTが過去ログの省略（truncated）を検知した際、ユーザーが明示的に入力したルールよりも過去の形式やパターン予測を優先する誤動作が確認された。

---

## 問題の構造
- 非表示テキストは中身を読めないが「存在フラグ」は渡される。
- ChatGPTはこのフラグをもとに「おそらくこの文脈では〜」と予測を開始。
- 結果として、ユーザーが貼ったテキストが無視される可能性がある。

---

## 事例
- `<<conversation too long; truncated>>` フラグを検知。
- 貼り付けられたのは会話ログだったが、記事本文と誤認。
- Fandom記事として処理し、誤ったファイル名で出力。

---

## 優先順位の理想と現実

| 優先順位（理想） | 優先順位（現実） |
|------------------|-------------------|
| 1. ユーザー明示ルール | 1. 履歴の形式・省略予測 |
| 2. 貼られたテキスト | 2. 文法的構造推測       |
| 3. 内部履歴補完     | 3. GitHub明示ルール（低）|

---

## 保存メモリの影響
- この現象は「保存メモリ」とは無関係。
- セッションの長さと処理予測構造によって引き起こされる。

---

## 対策
1. 非表示フラグを検知しても、処理を停止し、必ずユーザー確認を挟む。
2. 記事かログか不明な場合、「どちらですか？」と確認を出す。
3. GitHubのルールがある場合は**絶対優先**として扱う。
